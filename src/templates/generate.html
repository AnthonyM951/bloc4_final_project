{% extends 'base.html' %}
{% block title %}Generate Video{% endblock %}
{% block content %}
<div class="max-w-2xl mx-auto space-y-6">
  <h1 class="text-3xl font-semibold text-center">Generate Video</h1>
  <form id="gen-form" class="space-y-4">
    <input id="prompt" class="w-full px-4 py-2 rounded bg-slate-900 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-teal-500" type="text" placeholder="Enter prompt" required />
    <input id="image-url" class="w-full px-4 py-2 rounded bg-slate-900 border border-slate-700 focus:outline-none focus:ring-2 focus:ring-teal-500" type="text" placeholder="Image URL" required />
    <button class="w-full py-2 rounded bg-teal-500 hover:bg-teal-400 text-slate-900 font-semibold" type="submit">Generate</button>
  </form>
  <pre id="result" class="bg-slate-900 p-4 rounded text-sm"></pre>
</div>
<script>
const USER_ID = {{ user_id | tojson }};
document.getElementById('gen-form').addEventListener('submit', async (e) => {
  e.preventDefault();
  const prompt = document.getElementById('prompt').value;
  const imageUrl = document.getElementById('image-url').value;
  const res = await fetch('/submit_job', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      user_id: USER_ID,
      prompt,
      params: { image_url: imageUrl }
    })
  });
  const data = await res.json();
  document.getElementById('result').textContent = JSON.stringify(data, null, 2);
});
</script>
{% endblock %}
